<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<title></title>
	</head>

	<body>
		<canvas id="canvas" width="200" height="200" style="background-image: url('123.jpg');"></canvas>
	</body>

</html>
<script src="jquery-2.1.4.js" type="text/javascript" charset="utf-8"></script>
<script type="text/javascript">
	var canvas = document.querySelector('#canvas');
	var ctx = canvas.getContext('2d');

	ctx.fillStyle = '#ccc';
	ctx.fillRect(0, 0, canvas.width, canvas.height);
	ctx.globalCompositeOperation = 'destination-out';
	
    $(canvas).on('mousedown',function(){
    	$(this).on('mousemove',function(e){
    		
    		var x = e.pageX - canvas.offsetLeft;
    		var y = e.pageY - canvas.offsetTop;
    		ctx.beginPath();
    		ctx.arc(x,y,10,0,Math.PI * 2);
    		ctx.fill();
    		
    		var datas = ctx.getImageData(0,0,canvas.width,canvas.height).data;
//  		console.log(datas);
    		
    		var count = 0;
    		for(i = 0; i < datas.length; i+=4){
    			if(datas[i] == 0 && datas[i + 1] == 0 && datas[i + 2] == 0 && datas[i+3]==0) {
    				count++;
    			}
    		}
    		
    		console.log(count);
    		count >= canvas.width * canvas.height / 2 &&  ctx.clearRect(0,0,canvas.width,canvas.height);
    		
    		
    	})
    })
    
    
    $(canvas).on('mouseup',function(){
    	$(this).off('mousemove');
    })
	
	
	
	
</script>