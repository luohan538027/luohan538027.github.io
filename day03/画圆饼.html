<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<title></title>
	</head>

	<body>
		<canvas id="canvas" width="800" height="600" style="border: 1px solid red;"></canvas>

	</body>

</html>

<script type="text/javascript">
	var canvas = document.querySelector('#canvas');

	var Pie = (function() {
		var colors = (function() {
			return("aliceblue,antiquewhite,aqua,aquamarine,azure,beige,bisque,black,blanchedalmond,blue," +
				"blueviolet,brown,burlywood,cadetblue,chartreuse,chocolate,coral,cornflowerblue,cornsilk," +
				"crimson,cyan,darkblue,darkcyan,darkgoldenrod,darkgray,darkgreen,darkgrey,darkkhaki,darkmagenta," +
				"darkolivegreen,darkorange,darkorchid,darkred,darksalmon,darkseagreen,darkslateblue,darkslategray," +
				"darkslategrey,darkturquoise,darkviolet,deeppink,deepskyblue,dimgray,dimgrey,dodgerblue,firebrick," +
				"floralwhite,forestgreen,fuchsia,gainsboro,ghostwhite,gold,goldenrod,gray,green,greenyellow,grey," +
				"honeydew,hotpink,indianred,indigo,ivory,khaki,lavender,lavenderblush,lawngreen,lemonchiffon," +
				"lightblue,lightcoral,lightcyan,lightgoldenrodyellow,lightgray,lightgreen,lightgrey,lightpink," +
				"lightsalmon,lightseagreen,lightskyblue,lightslategray,lightslategrey,lightsteelblue,lightyellow," +
				"lime,limegreen,linen,magenta,maroon,mediumaquamarine,mediumblue,mediumorchid,mediumpurple," +
				"mediumseagreen,mediumslateblue,mediumspringgreen,mediumturquoise,mediumvioletred,midnightblue," +
				"mintcream,mistyrose,moccasin,navajowhite,navy,oldlace,olive,olivedrab,orange,orangered,orchid," +
				"palegoldenrod,palegreen,paleturquoise,palevioletred,papayawhip,peachpuff,peru,pink,plum,powderblue," +
				"purple,rebeccapurple,red,rosybrown,royalblue,saddlebrown,salmon,sandybrown,seagreen,seashell,sienna," +
				"silver,skyblue,slateblue,slategray,slategrey,snow,springgreen,steelblue,tan,teal,thistle,transparent," +
				"tomato,turquoise,violet,wheat,white,whitesmoke,yellow,yellowgreen").split(',');
		})();

		function Pie(opt) {
			var defaultOpt = {
				x: 200,
				y: 200,
				radius: 150,
				begin: -Math.PI / 2
			};

			for(var key in defaultOpt) {
				this[key] = defaultOpt[key];
			}

			for(var key in opt) {
				this[key] = opt[key];
			}
			
			var arr = ['data','canvas'];
			arr.forEach(function(v){
				if(!opt[v]) throw new Error('请传入必须的参数 ');
			})
			
			this.init();
		};

		Pie.prototype = {
			constructor: Pie,

			init: function() {
				this.getSum();
				this.getData();
				this.draw();
			},

			getSum: function() {
				var sum = 0;
				this.data.forEach(function(v) {
					sum += v;
				})
				this.sum = sum;
			},

			getData: function() {
				this.data2 = this.data.map(function(v, i) {
					var rate = v / this.sum;
					var step = 2 * Math.PI * rate;

					return {
						data: v,
						rate: rate,
						step: step
					}
				}, this)

			},

			draw: function() {
				var ctx = this.canvas.getContext('2d');
				var begin = this.begin;
				var end;
				for(i = 0; i < this.data2.length; i++) {
					end = begin + this.data2[i].step;
					ctx.beginPath();
					ctx.moveTo(this.x, this.y);
					ctx.arc(this.x, this.y, this.radius, begin, end);
					ctx.fillStyle = colors[i + 15];
					ctx.fill();
					begin = end;
				}
			}

		}
		return Pie;
	})();

	var pie = new Pie({
		x: 300,
		y: 300,
		data: [10, 20, 30, 40, 50, 60],
		begin: -Math.PI / 2,
		canvas: canvas,
		radius: 150
	});
</script>